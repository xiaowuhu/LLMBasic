
## 2.1 情感分析问题

在本章中，我们将要以情感分析为例子学习自然语言处理的初步知识。所谓情感分析，用电源评论举例，就是根据用户对一部电影的评论来分析该用户是否喜欢这部电影，用户的评论中可能有比较直接的“喜欢”或“不喜欢”的词语，也可能是“电影还可以拍得更吸引人”这类隐含的表达。

在本章中，我们将使用一个真实的电影评论数据集进行 NLP 任务中的**情感分析**（sentiment analysis），这个数据集是斯坦福大学的一个研究机构从 IMDB 网站上收集的，所以一般被称为 IMDB 数据集。

研究对电影评论的情感分析有什么用吗？直接看评分不就可以了吗？

在 IMDB 网站上，有些人忘记给评分，只写了一些文字；而在别的一些网站上，读者对于博主发布的内容的评论并没有评分，只有文字。所以，通过对 IMDB 语料的学习，可以帮助我们把训练好的模型应用于更多的场合，尽管这些场合可能与电影无关，比如判别博客上的评论的情感（支持还是反对）。

### 2.1.1 数据准备

IMDB 数据集中包含两类数据，一类是对某个电影的正面的评论，一共 25000 条，评分为 7~10 分，被分为正类，比如下面这个片段（原文为英文）：
```
如果你喜欢成人喜剧漫画，比如《南方公园》，那么这几乎是一个关于三个十几岁女孩在布
罗姆威尔高中的小冒险的类似形式......但它非常好。很好！
```
负类数据也有 25000 条，评分为 1~4 分，比如（原文为英文）：

```
这部电影太糟糕了，我忍不住坐下来不做别的事情。没有阴谋，也没有意义。我非常无聊，
对于一部关于单口相声演员的电影，我想不起一个笑话或一句有趣的台词值得描述。没有魅
力的政客说技术术语也同样有趣那么这是怎么做的呢？电影没有质量控制吗？......
```

当然，这些语料库都是英文的，而正类和负类数据各自被平分为训练集和测试集，所以，训练集中有 12500 条正类评论和 12500 条负类评论，测试集也是如此。下面是数据准备的步骤。

首先下载数据集，解压到一个目录中。运行【代码：H2_5_1_1_Download_Data.py】，缺省目录是 `{your_git_folder}/data/aclImdb/`，读者可以自行调整。

然后需要把 `train/pos`、`train/neg`、`test/pos`、`test/neg` 四个子目录中的各 12500 个文件合并为一个大的文本文件，分别叫做 `train/pos.txt`、`2train/neg.txt`、`test/pos.txt`、`test/neg.txt`，以便将来可以显著提高文件读取速度。运行【代码：H_6_1_2_Merge_Files.py】完成这一步。

在合并文件的同时，我们可以统计一下每条评论的平均长度，统计结果为 230 个词左右，最大长度为 2470，最小长度为 12。图 2.1.1 是每条评论的句子长度的直方图统计结果，据可以取中位数，即当评论的词数大于 500 时被截断，而小于 500 时会在后面补特殊的符号 \<pad\>（填充）。

<img src="./img/IMDB_hist.png" width=480>

图 2.1.1 每条评论的句子长度的直方图

### 2.1.2 知识准备

自然语言处理需要很多知识作为铺垫，如概率知识、贝叶斯定理、极大似然等，请读者自行复习相关内容。
